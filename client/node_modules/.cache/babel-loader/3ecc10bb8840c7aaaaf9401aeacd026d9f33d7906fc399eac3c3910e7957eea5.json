{"ast":null,"code":"var _jsxFileName = \"/workspaces/LocalReservationWebapp/client/src/App.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useMemo, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = 'http://localhost:4000/api';\nconst formatTime = time => {\n  const [hourStr, minuteStr] = time.split(':');\n  const hour = Number(hourStr);\n  if (Number.isNaN(hour)) {\n    return time;\n  }\n  const suffix = hour >= 12 ? 'PM' : 'AM';\n  const displayHour = (hour + 11) % 12 + 1;\n  return `${displayHour}:${minuteStr} ${suffix}`;\n};\nconst todayISO = () => {\n  const now = new Date();\n  const month = String(now.getMonth() + 1).padStart(2, '0');\n  const day = String(now.getDate()).padStart(2, '0');\n  return `${now.getFullYear()}-${month}-${day}`;\n};\nconst App = () => {\n  _s();\n  const [dateInput, setDateInput] = useState(todayISO());\n  const [activeDate, setActiveDate] = useState(null);\n  const [tables, setTables] = useState([]);\n  const [groups, setGroups] = useState([]);\n  const [reservations, setReservations] = useState([]);\n  const [selectedTableIds, setSelectedTableIds] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [modal, setModal] = useState(null);\n  const [toast, setToast] = useState(null);\n  const dragRef = useRef(null);\n  const reservationByGroup = useMemo(() => {\n    const map = new Map();\n    reservations.forEach(res => map.set(res.groupId, res));\n    return map;\n  }, [reservations]);\n  const groupMap = useMemo(() => {\n    const map = new Map();\n    groups.forEach(group => map.set(group.groupId, group));\n    return map;\n  }, [groups]);\n  const selectedGroupId = useMemo(() => {\n    if (selectedTableIds.length === 0) {\n      return null;\n    }\n    const groupIds = selectedTableIds.map(id => {\n      var _tables$find$groupId, _tables$find;\n      return (_tables$find$groupId = (_tables$find = tables.find(table => table.tableId === id)) === null || _tables$find === void 0 ? void 0 : _tables$find.groupId) !== null && _tables$find$groupId !== void 0 ? _tables$find$groupId : null;\n    }).filter(id => id !== null);\n    if (groupIds.length !== selectedTableIds.length) {\n      return null;\n    }\n    const unique = new Set(groupIds);\n    if (unique.size !== 1) {\n      return null;\n    }\n    return groupIds[0];\n  }, [selectedTableIds, tables]);\n  const showToast = (message, type) => {\n    setToast({\n      message,\n      type\n    });\n    setTimeout(() => setToast(null), 3000);\n  };\n  const loadLayout = async date => {\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_BASE}/layout/${date}`);\n      if (!response.ok) {\n        throw new Error('Failed to load layout.');\n      }\n      const payload = await response.json();\n      setTables(payload.tables);\n      setGroups(payload.groups);\n      setReservations(payload.reservations);\n      setSelectedTableIds([]);\n    } catch (err) {\n      showToast('Could not load layout.', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const openDate = async () => {\n    if (!dateInput) {\n      showToast('Pick a date first.', 'error');\n      return;\n    }\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_BASE}/layout/${dateInput}/init`, {\n        method: 'POST'\n      });\n      if (!response.ok) {\n        throw new Error('Failed to initialize layout.');\n      }\n      setActiveDate(dateInput);\n      await loadLayout(dateInput);\n    } catch (err) {\n      showToast('Could not open date.', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const refreshLayout = async () => {\n    if (!activeDate) {\n      return;\n    }\n    await loadLayout(activeDate);\n  };\n  const handleTableClick = (tableId, event) => {\n    if (event.shiftKey) {\n      setSelectedTableIds(prev => prev.includes(tableId) ? prev.filter(id => id !== tableId) : [...prev, tableId]);\n      return;\n    }\n    setSelectedTableIds([tableId]);\n  };\n  const handlePointerDown = (table, event) => {\n    if (event.button !== 0) {\n      return;\n    }\n    const target = event.currentTarget;\n    target.setPointerCapture(event.pointerId);\n    dragRef.current = {\n      tableId: table.tableId,\n      startX: table.x,\n      startY: table.y,\n      pointerStartX: event.clientX,\n      pointerStartY: event.clientY\n    };\n  };\n  const handlePointerMove = event => {\n    if (!dragRef.current) {\n      return;\n    }\n    const {\n      tableId,\n      startX,\n      startY,\n      pointerStartX,\n      pointerStartY\n    } = dragRef.current;\n    const deltaX = event.clientX - pointerStartX;\n    const deltaY = event.clientY - pointerStartY;\n    setTables(prev => prev.map(table => table.tableId === tableId ? {\n      ...table,\n      x: Math.max(0, startX + deltaX),\n      y: Math.max(0, startY + deltaY)\n    } : table));\n  };\n  const handlePointerUp = async event => {\n    if (!dragRef.current || !activeDate) {\n      return;\n    }\n    const {\n      tableId\n    } = dragRef.current;\n    dragRef.current = null;\n    const table = tables.find(item => item.tableId === tableId);\n    if (!table) {\n      return;\n    }\n    try {\n      await fetch(`${API_BASE}/layout/${activeDate}/table/${tableId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          x: table.x,\n          y: table.y\n        })\n      });\n      console.log(`Table ${table.name} (${table.tableId}) position: x=${table.x}, y=${table.y}`);\n    } catch (err) {\n      showToast('Could not save position.', 'error');\n    }\n  };\n  const handleGroup = async () => {\n    if (!activeDate) {\n      return;\n    }\n    if (selectedTableIds.length < 2) {\n      showToast('Select at least two tables to group.', 'error');\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/group`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          tableIds: selectedTableIds\n        })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to group.');\n      }\n      await refreshLayout();\n    } catch (err) {\n      showToast('Grouping failed. Ungroup tables first.', 'error');\n    }\n  };\n  const handleUngroup = async () => {\n    if (!activeDate || !selectedGroupId) {\n      showToast('Select a grouped set of tables.', 'error');\n      return;\n    }\n    if (reservationByGroup.has(selectedGroupId)) {\n      showToast('Delete the reservation before ungrouping.', 'error');\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/ungroup`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          groupId: selectedGroupId\n        })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to ungroup.');\n      }\n      await refreshLayout();\n    } catch (err) {\n      showToast('Ungroup failed.', 'error');\n    }\n  };\n  const handleTableDoubleClick = async table => {\n    var _groupMap$get;\n    if (!activeDate) {\n      return;\n    }\n    let groupId = table.groupId;\n    if (!groupId) {\n      try {\n        const response = await fetch(`${API_BASE}/layout/${activeDate}/group`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            tableIds: [table.tableId]\n          })\n        });\n        if (!response.ok) {\n          const payload = await response.json();\n          throw new Error(payload.error || 'Failed to create group.');\n        }\n        const payload = await response.json();\n        groupId = payload.groupId;\n        setTables(prev => prev.map(item => item.tableId === table.tableId ? {\n          ...item,\n          groupId\n        } : item));\n      } catch (err) {\n        showToast('Could not create group.', 'error');\n        return;\n      }\n    }\n    if (groupId === null) {\n      showToast('Could not open reservation.', 'error');\n      return;\n    }\n    const reservation = reservationByGroup.get(groupId) || null;\n    const groupTables = ((_groupMap$get = groupMap.get(groupId)) === null || _groupMap$get === void 0 ? void 0 : _groupMap$get.tableIds) || [table.tableId];\n    const tableNames = groupTables.map(id => {\n      var _tables$find2;\n      return ((_tables$find2 = tables.find(item => item.tableId === id)) === null || _tables$find2 === void 0 ? void 0 : _tables$find2.name) || `T${id}`;\n    }).join(', ');\n    setModal({\n      groupId,\n      tableNames,\n      reservation\n    });\n  };\n  const handleReservationSave = async data => {\n    if (!activeDate || !modal) {\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/reservation`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          groupId: modal.groupId,\n          ...data\n        })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to save reservation.');\n      }\n      setModal(null);\n      await refreshLayout();\n    } catch (err) {\n      showToast('Reservation save failed.', 'error');\n    }\n  };\n  const handleReservationDelete = async () => {\n    if (!activeDate || !(modal !== null && modal !== void 0 && modal.reservation)) {\n      return;\n    }\n    try {\n      await fetch(`${API_BASE}/layout/${activeDate}/reservation/${modal.reservation.id}`, {\n        method: 'DELETE'\n      });\n      setModal(null);\n      await refreshLayout();\n    } catch (err) {\n      showToast('Reservation delete failed.', 'error');\n    }\n  };\n  const reservationLabels = useMemo(() => {\n    return reservations.map(reservation => {\n      const tablesInGroup = tables.filter(table => table.groupId === reservation.groupId);\n      if (tablesInGroup.length === 0) {\n        return null;\n      }\n      const avgX = tablesInGroup.reduce((sum, table) => sum + table.x + table.width / 2, 0) / tablesInGroup.length;\n      const maxY = Math.max(...tablesInGroup.map(table => table.y + table.height));\n      return {\n        id: reservation.id,\n        x: avgX,\n        y: maxY + 10,\n        text: `${formatTime(reservation.time)} - ${reservation.name} (${reservation.partySize})`\n      };\n    }).filter(Boolean);\n  }, [reservations, tables]);\n  if (!activeDate) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"header\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Local Reservations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"page\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card date-picker\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Select date\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input\",\n              type: \"date\",\n              value: dateInput,\n              onChange: event => setDateInput(event.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button\",\n            onClick: openDate,\n            disabled: loading,\n            children: loading ? 'Opening...' : 'Open'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-note\",\n            children: \"The layout will initialize from the default template the first time you open a date.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this), toast && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `toast ${toast.type || ''}`.trim(),\n        children: toast.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Floor Plan for \", activeDate]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button secondary\",\n        onClick: () => setActiveDate(null),\n        children: \"Change date\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"toolbar\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: handleGroup,\n          children: \"Group\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button secondary\",\n          onClick: handleUngroup,\n          children: \"Ungroup\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button secondary\",\n          onClick: refreshLayout,\n          children: \"Refresh\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"footer-note\",\n          children: \"Shift+click to multi-select tables.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canvas\",\n        children: [tables.map(table => {\n          const reserved = table.groupId ? reservationByGroup.has(table.groupId) : false;\n          const selected = selectedTableIds.includes(table.tableId);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `table${reserved ? ' reserved' : ''}${selected ? ' selected' : ''}`,\n            style: {\n              width: table.width,\n              height: table.height,\n              left: table.x,\n              top: table.y\n            },\n            onClick: event => handleTableClick(table.tableId, event),\n            onDoubleClick: () => handleTableDoubleClick(table),\n            onPointerDown: event => handlePointerDown(table, event),\n            onPointerMove: handlePointerMove,\n            onPointerUp: handlePointerUp,\n            children: table.name\n          }, table.tableId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this);\n        }), reservationLabels.map(label => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"reservation-label\",\n          style: {\n            left: label.x,\n            top: label.y\n          },\n          children: label.text\n        }, label.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), modal && /*#__PURE__*/_jsxDEV(ReservationModal, {\n      modal: modal,\n      onClose: () => setModal(null),\n      onSave: handleReservationSave,\n      onDelete: handleReservationDelete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 9\n    }, this), toast && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `toast ${toast.type || ''}`.trim(),\n      children: toast.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 410,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"Wod8TaelInSZE9FLwLw8zGozb78=\");\n_c = App;\nconst ReservationModal = ({\n  modal,\n  onClose,\n  onSave,\n  onDelete\n}) => {\n  _s2();\n  var _modal$reservation, _modal$reservation2, _modal$reservation3, _modal$reservation3$p, _modal$reservation4;\n  const [time, setTime] = useState(((_modal$reservation = modal.reservation) === null || _modal$reservation === void 0 ? void 0 : _modal$reservation.time) || '18:30');\n  const [name, setName] = useState(((_modal$reservation2 = modal.reservation) === null || _modal$reservation2 === void 0 ? void 0 : _modal$reservation2.name) || '');\n  const [partySize, setPartySize] = useState(((_modal$reservation3 = modal.reservation) === null || _modal$reservation3 === void 0 ? void 0 : (_modal$reservation3$p = _modal$reservation3.partySize) === null || _modal$reservation3$p === void 0 ? void 0 : _modal$reservation3$p.toString()) || '2');\n  const [notes, setNotes] = useState(((_modal$reservation4 = modal.reservation) === null || _modal$reservation4 === void 0 ? void 0 : _modal$reservation4.notes) || '');\n  const submit = () => {\n    const size = Number(partySize);\n    if (!time || !name || Number.isNaN(size)) {\n      return;\n    }\n    onSave({\n      time,\n      name,\n      partySize: size,\n      notes\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-backdrop\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal\",\n      onClick: event => event.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Reservation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"footer-note\",\n        children: [\"Tables: \", modal.tableNames]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Time\", /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          type: \"time\",\n          value: time,\n          onChange: event => setTime(event.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Name\", /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          value: name,\n          onChange: event => setName(event.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 520,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Party size\", /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          type: \"number\",\n          min: \"1\",\n          value: partySize,\n          onChange: event => setPartySize(event.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Notes\", /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          value: notes,\n          onChange: event => setNotes(event.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"toolbar\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: submit,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button secondary\",\n          onClick: onClose,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 11\n        }, this), modal.reservation && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button secondary\",\n          onClick: onDelete,\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 546,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 507,\n    columnNumber: 5\n  }, this);\n};\n_s2(ReservationModal, \"513JTfLVC4rw8XeLc3UWyjk4GPM=\");\n_c2 = ReservationModal;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"App\");\n$RefreshReg$(_c2, \"ReservationModal\");","map":{"version":3,"names":["React","useMemo","useRef","useState","jsxDEV","_jsxDEV","API_BASE","formatTime","time","hourStr","minuteStr","split","hour","Number","isNaN","suffix","displayHour","todayISO","now","Date","month","String","getMonth","padStart","day","getDate","getFullYear","App","_s","dateInput","setDateInput","activeDate","setActiveDate","tables","setTables","groups","setGroups","reservations","setReservations","selectedTableIds","setSelectedTableIds","loading","setLoading","modal","setModal","toast","setToast","dragRef","reservationByGroup","map","Map","forEach","res","set","groupId","groupMap","group","selectedGroupId","length","groupIds","id","_tables$find$groupId","_tables$find","find","table","tableId","filter","unique","Set","size","showToast","message","type","setTimeout","loadLayout","date","response","fetch","ok","Error","payload","json","err","openDate","method","refreshLayout","handleTableClick","event","shiftKey","prev","includes","handlePointerDown","button","target","currentTarget","setPointerCapture","pointerId","current","startX","x","startY","y","pointerStartX","clientX","pointerStartY","clientY","handlePointerMove","deltaX","deltaY","Math","max","handlePointerUp","item","headers","body","JSON","stringify","console","log","name","handleGroup","tableIds","error","handleUngroup","has","handleTableDoubleClick","_groupMap$get","reservation","get","groupTables","tableNames","_tables$find2","join","handleReservationSave","data","handleReservationDelete","reservationLabels","tablesInGroup","avgX","reduce","sum","width","maxY","height","text","partySize","Boolean","className","children","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","onClick","disabled","trim","reserved","selected","style","left","top","onDoubleClick","onPointerDown","onPointerMove","onPointerUp","label","ReservationModal","onClose","onSave","onDelete","_c","_s2","_modal$reservation","_modal$reservation2","_modal$reservation3","_modal$reservation3$p","_modal$reservation4","setTime","setName","setPartySize","toString","notes","setNotes","submit","stopPropagation","min","_c2","$RefreshReg$"],"sources":["/workspaces/LocalReservationWebapp/client/src/App.tsx"],"sourcesContent":["import React, { useMemo, useRef, useState } from 'react';\n\ntype TableItem = {\n  tableId: number;\n  name: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  capacity?: number | null;\n  groupId: number | null;\n};\n\ntype Group = {\n  groupId: number;\n  tableIds: number[];\n};\n\ntype Reservation = {\n  id: number;\n  groupId: number;\n  time: string;\n  name: string;\n  partySize: number;\n  notes?: string | null;\n};\n\ntype ModalState = {\n  groupId: number;\n  tableNames: string;\n  reservation: Reservation | null;\n};\n\ntype ToastState = {\n  message: string;\n  type?: 'error';\n};\n\nconst API_BASE = 'http://localhost:4000/api';\n\nconst formatTime = (time: string) => {\n  const [hourStr, minuteStr] = time.split(':');\n  const hour = Number(hourStr);\n  if (Number.isNaN(hour)) {\n    return time;\n  }\n  const suffix = hour >= 12 ? 'PM' : 'AM';\n  const displayHour = ((hour + 11) % 12) + 1;\n  return `${displayHour}:${minuteStr} ${suffix}`;\n};\n\nconst todayISO = () => {\n  const now = new Date();\n  const month = String(now.getMonth() + 1).padStart(2, '0');\n  const day = String(now.getDate()).padStart(2, '0');\n  return `${now.getFullYear()}-${month}-${day}`;\n};\n\nconst App: React.FC = () => {\n  const [dateInput, setDateInput] = useState(todayISO());\n  const [activeDate, setActiveDate] = useState<string | null>(null);\n  const [tables, setTables] = useState<TableItem[]>([]);\n  const [groups, setGroups] = useState<Group[]>([]);\n  const [reservations, setReservations] = useState<Reservation[]>([]);\n  const [selectedTableIds, setSelectedTableIds] = useState<number[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [modal, setModal] = useState<ModalState | null>(null);\n  const [toast, setToast] = useState<ToastState | null>(null);\n\n  const dragRef = useRef<{\n    tableId: number;\n    startX: number;\n    startY: number;\n    pointerStartX: number;\n    pointerStartY: number;\n  } | null>(null);\n\n  const reservationByGroup = useMemo(() => {\n    const map = new Map<number, Reservation>();\n    reservations.forEach((res) => map.set(res.groupId, res));\n    return map;\n  }, [reservations]);\n\n  const groupMap = useMemo(() => {\n    const map = new Map<number, Group>();\n    groups.forEach((group) => map.set(group.groupId, group));\n    return map;\n  }, [groups]);\n\n  const selectedGroupId = useMemo(() => {\n    if (selectedTableIds.length === 0) {\n      return null;\n    }\n    const groupIds = selectedTableIds\n      .map((id) => tables.find((table) => table.tableId === id)?.groupId ?? null)\n      .filter((id): id is number => id !== null);\n    if (groupIds.length !== selectedTableIds.length) {\n      return null;\n    }\n    const unique = new Set(groupIds);\n    if (unique.size !== 1) {\n      return null;\n    }\n    return groupIds[0];\n  }, [selectedTableIds, tables]);\n\n  const showToast = (message: string, type?: 'error') => {\n    setToast({ message, type });\n    setTimeout(() => setToast(null), 3000);\n  };\n\n  const loadLayout = async (date: string) => {\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_BASE}/layout/${date}`);\n      if (!response.ok) {\n        throw new Error('Failed to load layout.');\n      }\n      const payload = await response.json();\n      setTables(payload.tables);\n      setGroups(payload.groups);\n      setReservations(payload.reservations);\n      setSelectedTableIds([]);\n    } catch (err) {\n      showToast('Could not load layout.', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const openDate = async () => {\n    if (!dateInput) {\n      showToast('Pick a date first.', 'error');\n      return;\n    }\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_BASE}/layout/${dateInput}/init`, {\n        method: 'POST'\n      });\n      if (!response.ok) {\n        throw new Error('Failed to initialize layout.');\n      }\n      setActiveDate(dateInput);\n      await loadLayout(dateInput);\n    } catch (err) {\n      showToast('Could not open date.', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const refreshLayout = async () => {\n    if (!activeDate) {\n      return;\n    }\n    await loadLayout(activeDate);\n  };\n\n  const handleTableClick = (tableId: number, event: React.MouseEvent) => {\n    if (event.shiftKey) {\n      setSelectedTableIds((prev) =>\n        prev.includes(tableId) ? prev.filter((id) => id !== tableId) : [...prev, tableId]\n      );\n      return;\n    }\n    setSelectedTableIds([tableId]);\n  };\n\n  const handlePointerDown = (table: TableItem, event: React.PointerEvent) => {\n    if (event.button !== 0) {\n      return;\n    }\n    const target = event.currentTarget as HTMLElement;\n    target.setPointerCapture(event.pointerId);\n    dragRef.current = {\n      tableId: table.tableId,\n      startX: table.x,\n      startY: table.y,\n      pointerStartX: event.clientX,\n      pointerStartY: event.clientY\n    };\n  };\n\n  const handlePointerMove = (event: React.PointerEvent) => {\n    if (!dragRef.current) {\n      return;\n    }\n    const { tableId, startX, startY, pointerStartX, pointerStartY } = dragRef.current;\n    const deltaX = event.clientX - pointerStartX;\n    const deltaY = event.clientY - pointerStartY;\n    setTables((prev) =>\n      prev.map((table) =>\n        table.tableId === tableId\n          ? { ...table, x: Math.max(0, startX + deltaX), y: Math.max(0, startY + deltaY) }\n          : table\n      )\n    );\n  };\n\n  const handlePointerUp = async (event: React.PointerEvent) => {\n    if (!dragRef.current || !activeDate) {\n      return;\n    }\n    const { tableId } = dragRef.current;\n    dragRef.current = null;\n    const table = tables.find((item) => item.tableId === tableId);\n    if (!table) {\n      return;\n    }\n    try {\n      await fetch(`${API_BASE}/layout/${activeDate}/table/${tableId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ x: table.x, y: table.y })\n      });\n      console.log(`Table ${table.name} (${table.tableId}) position: x=${table.x}, y=${table.y}`);\n    } catch (err) {\n      showToast('Could not save position.', 'error');\n    }\n  };\n\n  const handleGroup = async () => {\n    if (!activeDate) {\n      return;\n    }\n    if (selectedTableIds.length < 2) {\n      showToast('Select at least two tables to group.', 'error');\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/group`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ tableIds: selectedTableIds })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to group.');\n      }\n      await refreshLayout();\n    } catch (err) {\n      showToast('Grouping failed. Ungroup tables first.', 'error');\n    }\n  };\n\n  const handleUngroup = async () => {\n    if (!activeDate || !selectedGroupId) {\n      showToast('Select a grouped set of tables.', 'error');\n      return;\n    }\n    if (reservationByGroup.has(selectedGroupId)) {\n      showToast('Delete the reservation before ungrouping.', 'error');\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/ungroup`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ groupId: selectedGroupId })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to ungroup.');\n      }\n      await refreshLayout();\n    } catch (err) {\n      showToast('Ungroup failed.', 'error');\n    }\n  };\n\n  const handleTableDoubleClick = async (table: TableItem) => {\n    if (!activeDate) {\n      return;\n    }\n    let groupId = table.groupId;\n    if (!groupId) {\n      try {\n        const response = await fetch(`${API_BASE}/layout/${activeDate}/group`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ tableIds: [table.tableId] })\n        });\n        if (!response.ok) {\n          const payload = await response.json();\n          throw new Error(payload.error || 'Failed to create group.');\n        }\n        const payload = await response.json();\n        groupId = payload.groupId;\n        setTables((prev) =>\n          prev.map((item) =>\n            item.tableId === table.tableId ? { ...item, groupId } : item\n          )\n        );\n      } catch (err) {\n        showToast('Could not create group.', 'error');\n        return;\n      }\n    }\n\n    if (groupId === null) {\n      showToast('Could not open reservation.', 'error');\n      return;\n    }\n    const reservation = reservationByGroup.get(groupId) || null;\n    const groupTables = groupMap.get(groupId)?.tableIds || [table.tableId];\n    const tableNames = groupTables\n      .map((id) => tables.find((item) => item.tableId === id)?.name || `T${id}`)\n      .join(', ');\n    setModal({ groupId, tableNames, reservation });\n  };\n\n  const handleReservationSave = async (data: {\n    time: string;\n    name: string;\n    partySize: number;\n    notes?: string;\n  }) => {\n    if (!activeDate || !modal) {\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE}/layout/${activeDate}/reservation`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ groupId: modal.groupId, ...data })\n      });\n      if (!response.ok) {\n        const payload = await response.json();\n        throw new Error(payload.error || 'Failed to save reservation.');\n      }\n      setModal(null);\n      await refreshLayout();\n    } catch (err) {\n      showToast('Reservation save failed.', 'error');\n    }\n  };\n\n  const handleReservationDelete = async () => {\n    if (!activeDate || !modal?.reservation) {\n      return;\n    }\n    try {\n      await fetch(`${API_BASE}/layout/${activeDate}/reservation/${modal.reservation.id}`, {\n        method: 'DELETE'\n      });\n      setModal(null);\n      await refreshLayout();\n    } catch (err) {\n      showToast('Reservation delete failed.', 'error');\n    }\n  };\n\n  const reservationLabels = useMemo(() => {\n    return reservations\n      .map((reservation) => {\n        const tablesInGroup = tables.filter((table) => table.groupId === reservation.groupId);\n        if (tablesInGroup.length === 0) {\n          return null;\n        }\n        const avgX =\n          tablesInGroup.reduce((sum, table) => sum + table.x + table.width / 2, 0) /\n          tablesInGroup.length;\n        const maxY = Math.max(\n          ...tablesInGroup.map((table) => table.y + table.height)\n        );\n        return {\n          id: reservation.id,\n          x: avgX,\n          y: maxY + 10,\n          text: `${formatTime(reservation.time)} - ${reservation.name} (${reservation.partySize})`\n        };\n      })\n      .filter(Boolean) as Array<{ id: number; x: number; y: number; text: string }>;\n  }, [reservations, tables]);\n\n  if (!activeDate) {\n    return (\n      <div className=\"app\">\n        <header className=\"header\">\n          <h1>Local Reservations</h1>\n        </header>\n        <main className=\"page\">\n          <div className=\"card date-picker\">\n            <label>\n              Select date\n              <input\n                className=\"input\"\n                type=\"date\"\n                value={dateInput}\n                onChange={(event) => setDateInput(event.target.value)}\n              />\n            </label>\n            <button className=\"button\" onClick={openDate} disabled={loading}>\n              {loading ? 'Opening...' : 'Open'}\n            </button>\n            <div className=\"footer-note\">\n              The layout will initialize from the default template the first time you open a date.\n            </div>\n          </div>\n        </main>\n        {toast && (\n          <div className={`toast ${toast.type || ''}`.trim()}>{toast.message}</div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"app\">\n      <header className=\"header\">\n        <h1>Floor Plan for {activeDate}</h1>\n        <button className=\"button secondary\" onClick={() => setActiveDate(null)}>\n          Change date\n        </button>\n      </header>\n      <main className=\"page\">\n        <div className=\"toolbar\">\n          <button className=\"button\" onClick={handleGroup}>\n            Group\n          </button>\n          <button className=\"button secondary\" onClick={handleUngroup}>\n            Ungroup\n          </button>\n          <button className=\"button secondary\" onClick={refreshLayout}>\n            Refresh\n          </button>\n          <div className=\"footer-note\">Shift+click to multi-select tables.</div>\n        </div>\n        <div className=\"canvas\">\n          {tables.map((table) => {\n            const reserved = table.groupId ? reservationByGroup.has(table.groupId) : false;\n            const selected = selectedTableIds.includes(table.tableId);\n            return (\n              <div\n                key={table.tableId}\n                className={`table${reserved ? ' reserved' : ''}${selected ? ' selected' : ''}`}\n                style={{\n                  width: table.width,\n                  height: table.height,\n                  left: table.x,\n                  top: table.y\n                }}\n                onClick={(event) => handleTableClick(table.tableId, event)}\n                onDoubleClick={() => handleTableDoubleClick(table)}\n                onPointerDown={(event) => handlePointerDown(table, event)}\n                onPointerMove={handlePointerMove}\n                onPointerUp={handlePointerUp}\n              >\n                {table.name}\n              </div>\n            );\n          })}\n          {reservationLabels.map((label) => (\n            <div\n              key={label.id}\n              className=\"reservation-label\"\n              style={{ left: label.x, top: label.y }}\n            >\n              {label.text}\n            </div>\n          ))}\n        </div>\n      </main>\n      {modal && (\n        <ReservationModal\n          modal={modal}\n          onClose={() => setModal(null)}\n          onSave={handleReservationSave}\n          onDelete={handleReservationDelete}\n        />\n      )}\n      {toast && <div className={`toast ${toast.type || ''}`.trim()}>{toast.message}</div>}\n    </div>\n  );\n};\n\ntype ReservationModalProps = {\n  modal: ModalState;\n  onClose: () => void;\n  onSave: (data: { time: string; name: string; partySize: number; notes?: string }) => void;\n  onDelete: () => void;\n};\n\nconst ReservationModal: React.FC<ReservationModalProps> = ({\n  modal,\n  onClose,\n  onSave,\n  onDelete\n}) => {\n  const [time, setTime] = useState(modal.reservation?.time || '18:30');\n  const [name, setName] = useState(modal.reservation?.name || '');\n  const [partySize, setPartySize] = useState(\n    modal.reservation?.partySize?.toString() || '2'\n  );\n  const [notes, setNotes] = useState(modal.reservation?.notes || '');\n\n  const submit = () => {\n    const size = Number(partySize);\n    if (!time || !name || Number.isNaN(size)) {\n      return;\n    }\n    onSave({ time, name, partySize: size, notes });\n  };\n\n  return (\n    <div className=\"modal-backdrop\" onClick={onClose}>\n      <div className=\"modal\" onClick={(event) => event.stopPropagation()}>\n        <h2>Reservation</h2>\n        <div className=\"footer-note\">Tables: {modal.tableNames}</div>\n        <label>\n          Time\n          <input\n            className=\"input\"\n            type=\"time\"\n            value={time}\n            onChange={(event) => setTime(event.target.value)}\n          />\n        </label>\n        <label>\n          Name\n          <input\n            className=\"input\"\n            value={name}\n            onChange={(event) => setName(event.target.value)}\n          />\n        </label>\n        <label>\n          Party size\n          <input\n            className=\"input\"\n            type=\"number\"\n            min=\"1\"\n            value={partySize}\n            onChange={(event) => setPartySize(event.target.value)}\n          />\n        </label>\n        <label>\n          Notes\n          <input\n            className=\"input\"\n            value={notes}\n            onChange={(event) => setNotes(event.target.value)}\n          />\n        </label>\n        <div className=\"toolbar\">\n          <button className=\"button\" onClick={submit}>\n            Save\n          </button>\n          <button className=\"button secondary\" onClick={onClose}>\n            Cancel\n          </button>\n          {modal.reservation && (\n            <button className=\"button secondary\" onClick={onDelete}>\n              Delete\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}